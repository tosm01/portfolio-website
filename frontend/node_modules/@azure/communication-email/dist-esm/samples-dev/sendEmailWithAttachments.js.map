{"version":3,"file":"sendEmailWithAttachments.js","sourceRoot":"","sources":["../../samples-dev/sendEmailWithAttachments.ts"],"names":[],"mappings":"AAAA,uCAAuC;AACvC,kCAAkC;AAElC;;GAEG;AAEH,OAAO,EAAE,WAAW,EAAgB,MAAM,4BAA4B,CAAC;AAEvE,wEAAwE;AACxE,OAAO,KAAK,MAAM,MAAM,QAAQ,CAAC;AACjC,MAAM,CAAC,MAAM,EAAE,CAAC;AAEhB,MAAM,gBAAgB,GAAG,OAAO,CAAC,GAAG,CAAC,iCAAiC,CAAC,IAAI,EAAE,CAAC;AAC9E,MAAM,aAAa,GAAG,OAAO,CAAC,GAAG,CAAC,gBAAgB,CAAC,IAAI,EAAE,CAAC;AAC1D,MAAM,gBAAgB,GAAG,OAAO,CAAC,GAAG,CAAC,mBAAmB,CAAC,IAAI,EAAE,CAAC;AAEhE,MAAM,wBAAwB,GAAG,KAAK,IAAmB,EAAE;IACzD,0BAA0B;IAC1B,MAAM,WAAW,GAAgB,IAAI,WAAW,CAAC,gBAAgB,CAAC,CAAC;IAEnE,sCAAsC;IACtC,MAAM,YAAY,GAAiB;QACjC,MAAM,EAAE,aAAa;QACrB,OAAO,EAAE;YACP,OAAO,EAAE,qBAAqB;YAC9B,SAAS,EAAE,kBAAkB;YAC7B,IAAI,EAAE,wCAAwC;SAC/C;QACD,UAAU,EAAE;YACV,EAAE,EAAE;gBACF;oBACE,KAAK,EAAE,gBAAgB;oBACvB,WAAW,EAAE,eAAe;iBAC7B;aACF;SACF;QACD,WAAW,EAAE;YACX;gBACE,IAAI,EAAE,YAAY;gBAClB,cAAc,EAAE,KAAK;gBACrB,kBAAkB,EAAE,8BAA8B;aACnD;SACF;KACF,CAAC;IAEF,IAAI;QACF,yBAAyB;QACzB,MAAM,QAAQ,GAAG,MAAM,WAAW,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;QAEtD,OAAO,CAAC,GAAG,CAAC,cAAc,GAAG,QAAQ,CAAC,SAAS,CAAC,CAAC;KAClD;IAAC,OAAO,KAAK,EAAE;QACd,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;KACpB;AACH,CAAC,CAAC;AAEF,KAAK,wBAAwB,EAAE,CAAC","sourcesContent":["// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT License.\n\n/**\n * @summary Sends an email with a txt file attachment\n */\n\nimport { EmailClient, EmailMessage } from \"@azure/communication-email\";\n\n// Load the .env file (you will need to set these environment variables)\nimport * as dotenv from \"dotenv\";\ndotenv.config();\n\nconst connectionString = process.env[\"COMMUNICATION_CONNECTION_STRING\"] || \"\";\nconst senderAddress = process.env[\"SENDER_ADDRESS\"] || \"\";\nconst recipientAddress = process.env[\"RECIPIENT_ADDRESS\"] || \"\";\n\nconst sendEmailWithAttachments = async (): Promise<void> => {\n  // Create the Email Client\n  const emailClient: EmailClient = new EmailClient(connectionString);\n\n  // Create the Email Message to be sent\n  const emailMessage: EmailMessage = {\n    sender: senderAddress,\n    content: {\n      subject: \"This is the subject\",\n      plainText: \"This is the body\",\n      html: \"<html><h1>This is the body</h1></html>\",\n    },\n    recipients: {\n      to: [\n        {\n          email: recipientAddress,\n          displayName: \"Customer Name\",\n        },\n      ],\n    },\n    attachments: [\n      {\n        name: \"readme.txt\",\n        attachmentType: \"txt\",\n        contentBytesBase64: \"ZW1haWwgdGVzdCBhdHRhY2htZW50\",\n      },\n    ],\n  };\n\n  try {\n    // Send the email message\n    const response = await emailClient.send(emailMessage);\n\n    console.log(\"Message ID: \" + response.messageId);\n  } catch (error) {\n    console.log(error);\n  }\n};\n\nvoid sendEmailWithAttachments();\n"]}